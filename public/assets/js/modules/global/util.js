!function(e,t){"function"==typeof define&&define.amd?define(["jquery","underscore","common"],function(i,n,o){return t(e,i,n,o)}):e.util=t(e,e.jQuery||e.$,e._,e.C)}(this,function(root,$,_,C){var document=root.document,location=root.location,util={regMap:{table:/\t/g,line:/\n/g,intOrFloat:/^(-)?\d+(\.\d+)?$/,MobileNo:/^1[34587]\d{9}$/,CardNo:/^\d{16,}$/,MobileCode:/^\d{6,}$/,OrderPassword:/^\S{6,16}$/,parseThousands:/(\d{1,3})(?=(\d{3})+(?:$|\.))/g,bankCardNo:/(\d{4})(?=\d)/g,moneyTest:/^(0|[1-9]\d*)(\.\d{1,2})?$/,parseToStarNumber:/^(\d{4})(\d+)(\d{4})$/,parseRightFourStar:/^(\w+)(\w{4})$/,parseDateFormat:/\b(\d{4})\b[^\d]+(\d{1,2})\b[^\d]+(\d{1,2})\b(\s(\d{1,2})\:(\d{1,2})\:(\d{1,2}))?[^\d]?/,userBirthdayStarRegex:/(\d{2})\d{2}([^\d]+)\d+([^\d]+)\d?(\d)([^\d]+)?/,moneyReplace:/[^0-9\.]/g,verifyEmail:/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/,sfzNumber:/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/},lazyLoad:function(e){function t(){i.each(function(){$(this).data("src")&&-1!=this.src.indexOf(n)&&this.offsetTop-document.body.scrollTop-document.body.clientHeight<=-100&&(this.src=$(this).data("src"),this.onload=function(){this.style.display="none",$(this).removeClass("no-width"),$(this).fadeIn()})})}e=e||{};var i=e.images,n=e.defaultIcon;window.onscroll=function(){t()},t()},suspensionBar:function(){if(-1==location.href.indexOf("Admin/Tool")&&-1==location.href.indexOf("Login/regist")){var e=$(".footer").data("qq")||"214139579",t=document.getElementById("go-top");if(!t){var i=document.createElement("div");i.innerHTML='<div class="sideBar-1"><ul class="using-guide"><li>插件如何下载/使用？</li><li><a href="/Open/index/id/13.html">1，注册/登陆账号</a></li><li><a href="/Open/index/id/15.html">2，挑选添加工具</a></li><li><a href="/Open/index/id/11.html">3，下载安装客户端</a></li><li><a href="/Open/index/id/18.html">4，登陆客户端调用工具</a></li></ul></div><div class="sideBar-4"><span class="help-document"><a href="/open" target="_blank">使用帮助</a></span></div><div class="sideBar-2"><span class="sidebar_qq"><a target="_blank" rel="nofollow" href="http://wpa.qq.com/msgrd?v=3&amp;uin='+e+'&amp;site=qq&amp;menu=yes"><img border="0" src="/Public/Home/assets/images/qq-kf.jpg" title="在线客服" alt="在线客服">QQ客服</a></span></div><div class="sideBar-3"><span class="sidebar_go_top" id="sidebar_go_top" title="回到顶部" alt="回到顶部" style="display: block"></span></div>',document.body.appendChild(i);var n,o=document.getElementById("sidebar_go_top");$(".sidebar_qq").on("mouseenter mouseleave",function(e){"mouseenter"==e.type?$(this).find("img")[0].src="/Public/Home/assets/images/qq-kf-cur.jpg":$(this).find("img")[0].src="/Public/Home/assets/images/qq-kf.jpg"}),o.onclick=function(){var e=document.body.scrollTop;!new function(){return 0>=e?void clearTimeout(n):(e-=100,window.scrollTo(0,e),void(n=setTimeout(arguments.callee,10)))}};var a=function(){document.body.clientWidth<1409&&$(".sideBar-1").hide(),document.body.clientWidth<1256&&($(".sideBar-1").hide(),$(".sideBar-2").hide(),$(".sideBar-4").hide()),document.body.clientWidth>=1256&&document.body.clientWidth<=1409&&($(".sideBar-2").show(),$(".sideBar-4").show()),document.body.clientWidth>1409&&($(".sideBar-1").show(),$(".sideBar-2").show(),$(".sideBar-4").show());var e=$(".sideBar-3");e.css("right",(document.body.clientWidth-1080)/2-60),document.body.scrollTop>500?$(o).show():$(o).hide();var t=$(document).height()-document.body.clientHeight-document.body.scrollTop;303>=t?e.css("bottom",333-t):e.css("bottom","30px")};if(a(),$(window).resize(function(){a()}),$(window).scroll(function(){a()}),-1!=location.href.indexOf("release")||-1!=location.href.indexOf("Tools/edit"))return;require(["resize_extend"],function(){$(document).resize(function(){a()})})}}}(),share:function(obj){var _obj=obj||{},_setShareInfo=_obj.setShareInfo;with(window._bd_share_config={common:{bdText:"",bdDesc:"",bdUrl:"",bdPic:"",bdCustomStyle:"",onBeforeClick:_setShareInfo,onAfterClick:function(){}},share:[{tag:"share_1"},{tag:"share_2"}]},document)0[(getElementsByTagName("head")[0]||body).appendChild(createElement("script")).src="http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion="+~(-new Date/36e5)]},dateFormat:function(e,t){function i(e){return 10>e?"0"+e:e}var n=new Date(parseInt(e));return t?n.getFullYear()+t+i(n.getMonth()+1)+t+i(n.getDate())+" "+i(n.getHours())+":"+i(n.getMinutes()):n.getFullYear()+"年"+i(n.getMonth()+1)+"月"+i(n.getDate())+"日"},getParameter:function(e){var t=new RegExp("[&,?]"+e+"=([^\\&]*)","i"),i=t.exec(location.search);return i?i[1]:""},getHashParameter:function(e){var t=new RegExp("[&,#]"+e+"=([^\\&]*)","i"),i=t.exec(location.hash);return i?i[1]:""},uGet:function(e,t){var i;void 0!=typeof XMLHttpRequest?i=new XMLHttpRequest:void 0!=typeof ActiveXObject&&(i=new ActiveXObject),i.open("get",e,!0),i.send(null),i.onreadystatechange=function(){if(4==i.readyState&&(i.status>=200&&i.status<300||304==i.status)){var e=i.responseText;t&&t(e)}}},userStrength:function(e){e=e||{};var t=e.type,i=e.selectList||{},n=i.careerType||[],o=i.love||[],a=i.goodSoftware||[],r=e.callBackSure;$.when($.post("/User/hobby"),$.get("/Public/Home/assets/js/modules/User/view/user-strength.htm")).done(function(e,i){var l=e[0],c=i[0],s=document.createElement("div"),d=l.job,u=l.hobby,p=l.software;$.each(d,function(e,t){$.each(n,function(i,n){t==n&&(d[e]={name:t})})}),$.each(u,function(e,t){$.each(o,function(i,n){t==n&&(u[e]={name:t})})}),$.each(p,function(e,t){$.each(a,function(i,n){t==n&&(p[e]={name:t})})});var m={_job:d,_hobby:u,_software:p};s.innerHTML=_["template"](c)(m),document.body.appendChild(s),$("#user-career-type span").unbind("click").bind("click",function(){$("#user-career-type span").removeClass("user-strength-cur"),$(this).addClass("user-strength-cur")}),$("#user-love span").unbind("click").bind("click",function(){$("#user-love .user-strength-cur").length<=4?$(this).toggleClass("user-strength-cur"):$(this).removeClass("user-strength-cur")}),$("#user-good-software span").unbind("click").bind("click",function(){$("#user-good-software .user-strength-cur").length<=2?$(this).toggleClass("user-strength-cur"):$(this).removeClass("user-strength-cur")}),$(".dialog-close").unbind("click").bind("click",function(){if(0!=t){var e=new Date;e.setTime(e.getTime()+2592e6),document.cookie="is_show=true;expires="+e.toGMTString()+";path=/"}$("#user-strength").parent().remove()}),$("#user-btn-sure span").unbind("click").bind("click",function(){var e=$("#user-career-type .user-strength-cur"),i=$("#user-love .user-strength-cur"),n=$("#user-good-software .user-strength-cur"),o=[],a=[],l=[];if($.each(e,function(e,t){o.push(t.innerText)}),$.each(i,function(e,t){a.push(t.innerText)}),$.each(n,function(e,t){l.push(t.innerText)}),0==t)r&&r({careerType:o,love:a,goodSoftware:l}),$("#user-strength").parent().remove();else{if(o.length<=0)return void util.msg.error("请选择职业类型");if(l.length<=0)return void util.msg.error("请选择擅长的软件类型");if(a.length<=0)return void util.msg.error("请选择你的兴趣");C.ajax({url:"/User/setBobby",type:"post",dataType:"json",data:{job:o.join(","),software:l.join(","),hobby:a.join(",")},success:function(e){e.status?($("#user-strength").parent().remove(),util.msg.success(e.info)):util.msg.error(e.info)}})}})})},getCookie:function(e){for(var t=document.cookie.split(";"),i={},n=0,o=t.length;o>n;n++){var a=t[n].split("=");i[$.trim(a[0])]=a[1]}return i[e]},autoSides:function(e){require(["resize_extend"],function(){e=e||{};var t=e.wrap1,i=e.wrap2,n=e.w1Height,o=e.w2Height,a=e.wTop,r=function(){var e=n.height(),r=o.height();"fixed"==t.css("position")&&(e+=t.height()),"fixed"==i.css("position")&&(r+=t.height());var l=$(window).height(),c=$(document).height();if(e>r){if($(".footer")[0].offsetTop-$(window).scrollTop()-l<=15)return i.css({position:"fixed",bottom:303-(c-$(window).scrollTop()-l-15)+"px"}),void t.css({position:"relative",top:"0"});r-$(window).scrollTop()-(l-a)<=0?i.css({position:"fixed",bottom:"0px"}):i.css({position:"relative",bottom:"0"})}else{if(e>l-$(".footer").height()&&$(".footer")[0].offsetTop-$(window).scrollTop()-l<=15)return void t.css({});$(window).scrollTop()>=a?(t.css({position:"fixed",top:"0"}),i.css({position:"relative",bottom:"0"})):(t.css({position:"relative",top:"0"}),i.css({position:"relative",bottom:"0"}))}};r(),t.resize(function(){r()}),i.resize(function(){r()}),$(window).scroll(function(){r()})})},loadScript:function(e,t){var i=e.length;for(var n in e){var o=e[n];!function(e){var n=document.createElement("script");n.setAttribute("type","text/javascript"),n.setAttribute("src",e),document.getElementsByTagName("head")[0].appendChild(n),/msie/.test(window.navigator.userAgent.toLowerCase())?n.onreadystatechange=function(){("loaded"==this.readyState||"complete"==this.readyState)&&(n.parentNode.removeChild(n),i--,0==i&&t&&t())}:/gecko/.test(window.navigator.userAgent.toLowerCase())||/opera/.test(window.navigator.userAgent.toLowerCase())?n.onload=function(){n.parentNode.removeChild(n),i--,0==i&&t&&t()}:(n.parentNode.removeChild(n),i--,0==i&&t&&t())}(o)}},generateIconDialog:function(e){require(["text!/Public/Home/assets/js/modules/global/dialog/generate-icon-template.htm","jpicker","jsPinYin"],function(t){function i(e,t){for(var i=e.toString(16);i.length<t;)i="0"+i;return i}function n(e){if("#"==e.charAt(0))return e;var t=e.split(/\D+/),n=65536*Number(t[1])+256*Number(t[2])+Number(t[3]);return"#"+i(n,6)}function o(){return"#"+("00000"+(16777215*Math.random()+.5>>0).toString(16)).slice(-6)}function a(){$("#jpicker-init").jPicker({window:{expandable:!1},color:{alphaSupport:!0,active:new $.jPicker.Color({ahex:"99330099"})}},function(e,t){var i=e.val("all");$("#Commit").css({backgroundColor:i&&"#"+i.hex||"transparent"}),v.css({backgroundColor:"#"+i.hex}),-1!=v[0].className.indexOf("bgColor")?(c[l].style.backgroundColor="#"+i.hex,v.next().text("#"+i.hex)):($($(".font-position")[l]).css({color:"#"+i.hex}),v.next().text("#"+i.hex)),$(this).hide()},function(e,t){t==y.get(0)&&alert("Color set from button");var i=e.val("hex");e.val("r"),e.val("g"),e.val("b");b.css({backgroundColor:i&&"#"+i||"transparent"}),v.css({backgroundColor:"#"+i}),-1!=v[0].className.indexOf("bgColor")?(c[l].style.backgroundColor="#"+i,v.next().text("#"+i)):($($(".font-position")[l]).css({color:"#"+i}),v.next().text("#"+i))},function(e,t){$(this).hide()})}if($("#icon-dialog").length<=0){var r=document.createElement("div");r.innerHTML=t,document.body.appendChild(r)}var l=0,c=$(".icon-preview"),s=!1,d=function(){var e=o(),t=$(".select-bgColor"),i=$(".font-position");t[0].style.backgroundColor=e,t.next().text(e),s?c[l].style.backgroundColor=e:(c[0].style.backgroundColor=e,c[1].style.backgroundColor=o(),c[2].style.backgroundColor=o());var n=o(),a=$(".select-fontColor");a[0].style.backgroundColor=n,a.next().text(n),i.length>0&&(i[l].style.color=n);var r=14+parseInt(86*Math.random());$("#change-font-size").val(r),i.length>0&&(i[l].style.fontSize=r+"pt")};d(),$(".icon-random-generate").unbind("click").bind("click",function(e){s=!0,d()}),$("#change-font-size").change(function(){var e=$(".font-position");e.length>0&&(e[l].style.fontSize=this.value+"pt")});var u=$("#input_text");u.change(function(){if($.trim(this.value)){var e=pinyin.getCamelChars(this.value),t=this.value.split("");if(1==t.length){c[0].innerHTML='<span class="font-position">'+t[0]+"</span>",c[1].innerHTML='<span class="font-position">'+e+"</span>",c[2].innerHTML="";var i=$(".font-position");i[l].style.fontSize=$("#change-font-size").val()+"pt",i[l].style.color=$(".select-fontColor").next().text(),0==l?(i[1].style.fontSize=14+parseInt(86*Math.random())+"pt",i[1].style.color=o()):(i[0].style.fontSize=14+parseInt(86*Math.random())+"pt",i[0].style.color=o())}else if(2==t.length){c[0].innerHTML='<span class="font-position">'+t[0]+"</span>",c[1].innerHTML='<span class="font-position">'+t[1]+"</span>",c[2].innerHTML='<span class="font-position">'+e+"</span>";var n=$(".font-position");n[l].style.fontSize=$("#change-font-size").val()+"pt",n[l].style.color=$(".select-fontColor").next().text(),0==l?(n[1].style.fontSize=14+parseInt(86*Math.random())+"pt",n[1].style.color=o(),n[2].style.fontSize=14+parseInt(86*Math.random())+"pt",n[2].style.color=o()):1==l?(n[0].style.fontSize=14+parseInt(86*Math.random())+"pt",n[0].style.color=o(),n[2].style.fontSize=14+parseInt(86*Math.random())+"pt",n[2].style.color=o()):(n[0].style.fontSize=14+parseInt(86*Math.random())+"pt",n[0].style.color=o(),n[1].style.fontSize=14+parseInt(86*Math.random())+"pt",n[1].style.color=o())}}}),$(".dialog-close").unbind("click").bind("click",function(){$("#icon-dialog").parent().remove()}),u.focus(),u.css("border","1px solid #03A9F4"),u.unbind("focusin focusout").bind("focusin focusout",function(e){"focusin"==e.type?$(this).css("border","1px solid #03A9F4"):$(this).css("border","1px solid #aaa")}),$(".icon-preview-choice button").unbind("click").bind("click",function(){$(this).siblings().removeClass("icon-preview-cur"),$(this).addClass("icon-preview-cur"),l=$(".icon-preview-cur").index()});var p=$("body");p.off("click",".close").on("click",".close",function(){$("#jpicker-init").hide()});var m,g;$(".font-pos-x,.font-pos-y").unbind("change").bind("change",function(){var e=$(".font-position");e.length<=0||(-1!=this.className.indexOf("font-pos-x")?(m=this.value,e[l].style.left=m+"px"):(g=this.value,e[l].style.top=g+"px"))}),p.off("click",".use-this-icon").on("click",".use-this-icon",function(){var t=$("#input_text").val();if(!$.trim(t))return void util.msg.warning("请输入关键字");var i=$(".font-position")[l],o=$(i).parent()[0].style.backgroundColor.split(","),a=i.innerText,r=i.style.fontSize.replace("pt",""),c=n(i.style.color),s=o[0].match(/\d/g).join(""),d=o[1].match(/\d/g).join(""),u=o[2].match(/\d/g).join(""),p=i.style.left.replace("px",""),m=i.style.top.replace("px","");C.ajax({url:"/Upload/fontIcon",data:{font:a,font_size:r,fc:c,bg_r:s,bg_g:d,bg_b:u,x:p,y:m},success:function(t){t.status?($("#icon-dialog").parent().remove(),e&&e(t.url)):util.msg.error(t.info)},error:function(){util.msg.error("网络异常，请稍后重试")}})});var f,h,v;p.off("click",".select-color").on("click",".select-color",function(e){var t=$("#jpicker-init");$("#jpicker-init .jPicker:visible").length<=0?(t.show(),t.find(".jPicker").show()):t.hide(),f=$(e.target).closest(".icon-s1"),h=f.find(".icon-font"),v=$(e.target)});var b=$("#Live"),y=$("#LiveButton");a()})},noviceGuidance:function(e){if(1===$(".header").data("login")){var t=localStorage.getItem("TIPDIALOG-1"),i=localStorage.getItem("TIPDIALOG-2");if(1==e&&3==t)return;if(2==e&&3==i)return;(1==e||2==e)&&(location.href="#bbd",require(["text!/Public/Home/assets/js/modules/Tools/view/novice-guidance-template.htm"],function(n){if($("#courseTip").length<=0){var o=document.createElement("div");o.innerHTML=_["template"](n)({type:e}),document.body.appendChild(o),document.documentElement.style.overflow="hidden",document.getElementsByTagName("body")[0].scrollTop=0,1==e?1==t?localStorage.setItem("TIPDIALOG-1",2):2==t?localStorage.setItem("TIPDIALOG-1",3):localStorage.setItem("TIPDIALOG-1",1):1==i?localStorage.setItem("TIPDIALOG-2",2):2==i?localStorage.setItem("TIPDIALOG-2",3):localStorage.setItem("TIPDIALOG-2",1),$(".close-pic").unbind("click").bind("click",function(){$("#courseTip").parent().remove(),document.documentElement.style.overflow="auto"})}}))}}(-1!=location.pathname.indexOf("ToolManage/usingTools")?2:-1!=location.pathname.indexOf("tools")&&location.pathname.length<=7?1:0),hbDialog:function(e){var t,i=e||{},n=i.url,o=i.showGift,a=i.drawRedPacket,r=i.username,l=i.info,c=(i.type,i.time),s=i.money,d=i.showShare,u=i.showHb,p=i.callBackFun;void 0!=typeof XMLHttpRequest?t=new XMLHttpRequest:void 0!=typeof ActiveXObject&&(t=new ActiveXObject),t.open("get","/Public/Home/assets/js/modules/Tools/view/red-packet-template.htm",!0),t.send(null),t.onreadystatechange=function(){if(4==t.readyState){if(t.status>=200&&t.status<300||304==t.status){var e=t.responseText,i=$("#hb-dialog");if(i.length<=0){var m=document.createElement("div");m.innerHTML=_["template"](e)({data:{showGift:o,drawRedPacket:a,showShare:d,share_url:n,info:l,money:s,showHb:u,time:c,username:r}}),document.body.appendChild(m)}else i[0].outerHTML=_["template"](e)({data:{showGift:o,drawRedPacket:a,showShare:d,share_url:n,info:l,money:s,showHb:u,time:c,username:r}}),1==o&&$("#hb-dialog ._dialog").css({top:200,animation:"show 0.3s ease 0s 1 alternate",webkitAnimation:"show 0.3s ease 0s 1 alternate",mozAnimation:"show 0.3s ease 0s 1 alternate",oAnimation:"show 0.3s ease 0s 1 alternate"}),i.show()}$("#tools-share-2 .share-more,#tools-share-2 .share-menu").unbind("mouseenter mouseleave").bind("mouseenter mouseleave",function(e){"share-more"==e.currentTarget.className?"mouseenter"==e.type?$(e.currentTarget).siblings(".share-menu").show():util.shareTime=setTimeout(function(){$(e.currentTarget).siblings(".share-menu").hide()},200):"share-menu"==e.currentTarget.className&&("mouseleave"==e.type?$(e.currentTarget).hide():clearTimeout(util.shareTime))}),$(".dialog-close-hb,.ignore").unbind("click").bind("click",function(e){$("#hb-dialog").hide(),$(e.currentTarget).parent().hide()}),$("#toGetHb").unbind("click").bind("click",function(e){p&&p(e)}),$(".active").unbind("click").bind("click",function(e){C.ajax({url:"/RedPacket/activeRedPacket",data:{code:$(".tools-detail-w1").data("pid")},success:function(e){e.status?(util.msg.success(e.info),setTimeout(function(){$("#hb-dialog").hide()},1e3)):util.msg.warning(e.info)},error:function(){util.msg.error("网络异常，请稍后重试")}})})}}},dialog:function(e){var t=e||{},i=t.title,n=t.content,o=t.hideCancel||!1,a=t.hideOk||!1,r=t.callBackOk,l=t.callBackNo,c=document.getElementById("_dialog");if(!c){var s=document.createElement("div");s.innerHTML='<div id="_dialog"><div class="mask"></div><div class="dialog"><div class="dialog-head"><span class="dialog-title">'+i+'</span><span class="dialog-close">x</span></div><div class="dialog-wrap"><p class="dialog-p1">'+n+'</p><div class="dialog-btn-wrap">'+(o?'<span class="dialog-btn1" id="dialog-ok">确定</span>':a?'<span class="dialog-btn2" id="dialog-cancel">取消</span>':o&&a?"":'<span class="dialog-btn1" id="dialog-ok">确定</span><span class="dialog-btn2" id="dialog-cancel">取消</span>')+"</div></div></div></div> ",document.body.appendChild(s)}$(".dialog-close,#dialog-cancel").unbind("click").bind("click",function(){$("#_dialog").parent().remove(),l&&l()}),$("#dialog-ok").unbind("click").bind("click",function(){$("#_dialog").parent().remove(),r&&r()})},tryDsDialog:function(e){var t=e||{},i=t.title,n=t.content,o=t.showTrial,a=t.toolsTrial,r=t.toolsBuy,l=document.getElementById("_dialog-tip");if(!l){var c=document.createElement("div");c.innerHTML='<div id="_dialog-tip"><div class="mask"></div><div class="dialog"><div class="dialog-head"><span class="dialog-title">'+i+'</span></div><div class="dialog-close">x</div><div class="dialog-wrap"><p class="dialog-p1">'+n+'</p><div class="dialog-btn-wrap">'+(o?'<span class="dialog-btn1" id="tools-trial">我要试用</span><span class="dialog-btn1" id="tools-buy">打赏后使用</span>':'<span class="dialog-btn1" id="tools-buy">打赏后使用</span>')+"</div></div></div></div>",document.body.appendChild(c)}var s=function(){$("#_dialog-tip").parent().remove(),$("#_dialog-buy").show(),r&&r()},d=function(){$("#_dialog-tip").parent().remove(),a&&a()};$(".dialog-close").unbind("click").bind("click",function(){$("#_dialog-tip").parent().remove()}),$("#tools-buy").unbind("click").bind("click",s),$("#tools-trial").unbind("click").bind("click",d)},buyDialog:function(e){e=e||{};var t=Number(e.price_week)||0,i=Number(e.price_month)||0,n=Number(e.price_year)||0,o=Number(e.price_forever)||0,a=e.tid,r=e.payCallBack;sessionStorage.setItem("BUYDATA",JSON.stringify({price_week:t,price_month:i,price_year:n,price_forever:o,tid:a,payCallBack:r}));var l;require(["text!/Public/Home/assets/js/modules/global/dialog/buy-template.htm"],function(e){function c(e){if(m=Number(p.val()),"tools-buy-add"==e.target.className)m++;else if("tools-buy-reduce"==e.target.className){if(1>=m)return;m--}p.val(m),l=h?(h*g*m).toFixed(2):(g*m).toFixed(2),$(".tools-buy-totalMoney").text(l+"元")}function s(e){-1===e.currentTarget.className.indexOf("tools-buy-price-cur")&&(f=$(e.currentTarget).data("price_type"),$(e.currentTarget).siblings(".tools-buy-price").removeClass("tools-buy-price-cur"),$(e.currentTarget).addClass("tools-buy-price-cur"),g=Number($(e.currentTarget).find("i").text()),m=1,h="",$("#tools-buy-val").val(1),$(".yhm-input").hide(),$(".yhm-tip").show(),$(".use-yhm").removeClass("yhm-cur"),2==f&&(g=t),3==f&&(g=i),4==f&&(g=n),5==f?(g=o,m=1,$(".tools-buy-setCircle").hide()):$(".tools-buy-setCircle").show(),l=(g*m).toFixed(2),d())}function d(){5==f?h?$(".tools-buy-totalMoney").text((h*o).toFixed(2)+"元"):$(".tools-buy-totalMoney").text(o.toFixed(2)+"元"):h?$(".tools-buy-totalMoney").text((h*g*m).toFixed(2)+"元"):($(".reset_amount").html(g.toFixed(2)+"<em>元/"+(2==f?"周</em>":3==f?"月</em>":4==f?"年</em>":"")),$(".tools-buy-totalMoney").text((g*m).toFixed(2)+"元"))}if($("#_dialog-buy").length<=0){var u=document.createElement("div");u.innerHTML=_["template"](e)({data:{price_week:t,price_month:i,price_year:n,price_forever:o}}),document.body.appendChild(u)}var p=$("#tools-buy-val"),m=Number(p.val()),g=i,f=3;l=(g*m).toFixed(2),$(".tools-buy-totalMoney").text((g*m).toFixed(2)+"元"),$(".tools-buy-price").unbind("click").bind("click",s),$(".dialog-close").unbind("click").bind("click",function(){$("#_dialog-buy").parent().remove()});var h;$(".use-yhm,.buy-agree").unbind("click").bind("click",function(e){return-1!=this.className.indexOf("buy-agree")?void $(e.currentTarget).toggleClass("yhm-cur"):($(".get_yhm").val(""),-1==e.currentTarget.className.indexOf("yhm-cur")?($(e.currentTarget).addClass("yhm-cur"),$(".yhm-input").show(),$(".yhm-tip").hide()):(h="",$(e.currentTarget).removeClass("yhm-cur"),$(".yhm-input").hide(),$(".yhm-tip").show()),l=h?(h*g*m).toFixed(2):(g*m).toFixed(2),void $(".tools-buy-totalMoney").text(l+"元"))});var v;$(".btn-yhm").unbind("click").bind("click",function(){return v=$(".get_yhm").val(),""==v?void util.msg.warning("请输入优惠码"):void C.ajax({url:"/Tools/checkPromo",type:"post",data:{tid:a,promo:v},success:function(e){e.status?(h=e.info.promo,l=(h*g*m).toFixed(2),$(".tools-buy-totalMoney").text(l+"元")):util.msg.error(e.info)},error:function(){util.msg.error("优惠码使用失败")}})});var b=function(){return-1!=$(".buy-agree")[0].className.indexOf("yhm-cur")?!0:!1};$(".tools-buy-calculator").unbind("click").bind("click",c),$(".integral-pay").unbind("click").bind("click",function(){return b()?($("#_dialog-buy").parent().remove(),void util.integralPay({tid:a,price_type:f,price_way:1,num:m,promo:v,purpose:0,payAmount:l,curDialog:"#_dialog-buy",nextDialog:"#_dialog-integral-pay",payCallbackOk:function(e){r&&r(e)}})):void util.msg.warning("请勾选同意购买按钮")}),$(".wx-pay").unbind("click").bind("click",function(){util.wxPay()}),$(".zfb-pay").unbind("click").bind("click",function(){return b()?($("#_dialog-buy").parent().remove(),void util.zfbPay({tid:a,price_type:f,price_way:3,num:m,promo:v,purpose:0,payAmount:l})):void util.msg.warning("请勾选同意购买按钮")})})},integralPay:function(e){e=e||{};var t=e.tid,i=e.num,n=e.promo,o=e.purpose,a=e.sell_uid,r=e.price_type,l=e.mark,c=e.payAmount,s=e.payCallbackOk;require(["text!/Public/Home/assets/js/modules/global/dialog/integral-pay-template.htm"],function(d){if($("#_dialog-integral-pay").length<=0){var u=document.createElement("div");u.innerHTML=d,document.body.appendChild(u)}var p=$(e.nextDialog);$(e.curDialog);C.ajax({url:"/User/getIntegral",type:"post",success:function(e){var t=e.integral,i=e.exchange;$(".zf-p1 i").text(t),i>0?$(".zf-p2 i").text(i):$(".zf-p2").hide(),$(".zf-p3 i").text(c),Number(c)<=Number(t)?($(".integral-pay-p1").show(),$(".integral-pay-p2").hide(),$("#no_more_integral").hide()):($(".integral-pay-p1").hide(),$(".integral-pay-p2").show(),$("#no_more_integral").show())}}),$("#use-other-pay").unbind("click").bind("click",function(){if($("#_dialog-integral-pay").parent().remove(),0==o){var e=JSON.parse(sessionStorage.getItem("BUYDATA"));sessionStorage.removeItem("BUYDATA"),util.buyDialog({price_week:e.price_week,price_month:e.price_month,price_year:e.price_year,price_forever:e.price_forever,tid:e.tid,payCallBack:e.payCallBack})}else if(1==o){var t=JSON.parse(sessionStorage.getItem("REWARDDATA"));sessionStorage.removeItem("REWARDDATA"),util.rewardDeveloperDialog({name:t.name,uid:t.uid,head_pic:t.head_pic,callBackOk:t.callBackOk})}}),$(".dialog-close").unbind("click").bind("click",function(){$("#_dialog-integral-pay").parent().remove()}),$(".integral-pay-btn").unbind("click").bind("click",function(){var e,d;1==o?(e={sell_uid:a,recharge_amount:c,mark:l,price_way:1},d="/User/exceptional"):0==o&&(e={tid:t,price_type:r,price_way:1,num:i,promo:n},d="/Tools/addTool"),C.ajax({url:d,data:e,success:function(e){return 402==e.status?($(".integral-pay-p1").hide(),void $(".integral-pay-p2").show()):void(e.status?(util.msg.success(e.info),p.hide(),s&&s(e)):util.msg.error(e.info))},error:function(){util.msg.error("网络异常，请稍后重试")}})})})},wxPay:function(e){$.get("/Payment/onlineWxpay",function(e){util.msg.warning(e.info)})},zfbPay:function(e){if(0==$(".header").data("login"))return void(location.href="/Login/index/");e=e||{};var t,i,n=e.tid,o=e.num,a=e.promo,r=e.purpose,l=e.mark,c=e.sell_uid,s=e.price_type,d=e.payAmount;1==r?(t={sell_uid:c,mark:l,recharge_amount:d,price_way:3},i="/User/exceptional"):0==r?(t={tid:n,price_type:s,price_way:3,num:o,promo:a},i="/Tools/addTool"):2==r&&(t={recharge_amount:d,price_way:3},i="/User/recharge");var u=window.open();C.ajax({url:i,data:t,success:function(e){0==r&&(util._order_num=e.order_num),util._order_url=e.url,"jump"==e.status?u.location=e.url:e.status?(u.close(),$("#buy-result-page").parent().remove(),util.msg.info("添加成功")):(u.close(),util.msg.error(e.info))},error:function(){util.msg.error("网络异常，请稍后重试")}}),require(["text!/Public/Home/assets/js/modules/global/dialog/buy-result-template.htm"],function(e){if($("#buy-result-page").length<=0){var t=document.createElement("div");t.innerHTML=_["template"](e)({data:{orderAmount:d}}),document.body.appendChild(t)}$("#buy-success").unbind("click").bind("click",function(){C.ajax({url:"/Payment/checkOrder",data:{order_num:util._order_num},success:function(e){e.status?($("#buy-result-page").parent().remove(),util.msg.info(e.info)):util.msg.error(e.info)},error:function(){util.msg.error("网络异常，请稍后重试")}})}),$(".dialog-close").unbind("click").bind("click",function(){C.ajax({url:"/Payment/checkOrder",data:{order_num:util._order_num},success:function(e){$("#buy-result-page").parent().remove(),e.status?util.msg.info(e.info):util.msg.error(e.info)},error:function(){util.msg.error("网络异常，请稍后重试")}})}),$("#pay-has-problem").unbind("click").bind("click",function(){window.open(util._order_url)})})},integralTX:function(e){var t=e||{},i=t.txCallBack,n=t.account,o=t.amount;require(["text!/Public/Home/assets/js/modules/global/dialog/integral-tx-template.htm"],function(e){if($("#_dialog-tx-integral").length<=0){var t=document.createElement("div");t.innerHTML=_["template"](e)({data:{account:n,amount:o}}),document.body.appendChild(t)}$(".toRz").hide(),$(".dialog-close,#tx-no").unbind("click").bind("click",function(){$("#_dialog-tx-integral").parent().remove()});var a=$("#amount-tx");a.val(100*parseInt(o/100)),a.on("mouseup keyup",function(){var e=this;e.value.match(/\D/)&&(e.value=e.value.replace(/\D/,""))}),$("#tx-ok").unbind("click").bind("click",function(){if(!$.trim(n))return $("#toBk").show(),$("#zfb_account").text("无效"),void util.msg.warning("请先设置支付宝账号");var e=Number($("#amount-tx").val());return 0>=e?void util.msg.warning("提现金额必须大于零"):e>o?void util.msg.warning("大于可提现金额"):void C.ajax({url:"/User/withdrawApply",data:{money:e},success:function(e){402==e.status?(util.msg.warning(e.info),$("#toRz").show()):e.status?(setTimeout(function(){i&&i()},1e3),util.msg.success(e.info),$("#_dialog-tx-integral").parent().remove()):util.msg.error(e.info)},error:function(){util.msg.error("网络异常，请稍后重试")}})})})},rewardDeveloperDialog:function(e){var t=e||{},i=t.name,n=t.uid,o=t.head_pic,a=t.callBackOk;sessionStorage.setItem("REWARDDATA",JSON.stringify({name:i,uid:n,head_pic:o,callBackOk:a})),require(["text!/Public/Home/assets/js/modules/global/dialog/reward-developer-template.htm"],function(e){if($("#_rewardDialog").length<=0){var t=document.createElement("div");t.innerHTML=_["template"](e)({data:{name:i,head_img:o}}),document.body.appendChild(t)}var r=$("#getAmount_reward");r.val("￥"+new Number("6.66").toFixed(2)),r.focus(),$(".dialog-close").unbind("click").bind("click",function(){$("#_rewardDialog").parent().remove()}),$("#reward-now").unbind("click").bind("click",a),$("#setAmount").unbind("click").bind("click",function(){r.val("￥"+new Number(50*Math.random()).toFixed(2))}),r.on("keyup",function(){var e=this;e.value="￥"+e.value.replace(/[^\d.]/g,"")}),r.unbind("change").bind("change",function(){var e=this,t=new Number(e.value.replace(/￥/,"")).toFixed(2);0>=t&&(e.value="￥1.00"),e.value="￥"+t}),$(".wx-pay").unbind("click").bind("click",function(){util.wxPay()});var l=$(".reward-d1 input");l.val("点赞是美意，打赏是鼓励"),$(".zfb-pay").unbind("click").bind("click",function(){var e=r.val().replace("￥","");return 0>=e?(r.focus(),void util.msg.warning("输入金额必须大于零")):($("#_rewardDialog").parent().remove(),void util.zfbPay({mark:l.val(),sell_uid:n,payAmount:e,purpose:1,payCallbackOk:function(e){a&&a(e)}}))}),$(".integral-pay").unbind("click").bind("click",function(){var e=r.val().replace("￥","");return 0>=e?(r.focus(),void util.msg.warning("输入金额必须大于零")):($("#_rewardDialog").parent().remove(),$(".integral-pay-p1").show(),$(".integral-pay-p2").hide(),void util.integralPay({mark:l.val(),sell_uid:n,payAmount:e,purpose:1,curDialog:"#_rewardDialog",nextDialog:"#_dialog-integral-pay",payCallbackOk:function(e){a&&a(e)}}))})})},IntegralRechargeDialog:function(e){var t=e||{},i=t.enable,n=t.callBackOk;require(["text!/Public/Home/assets/js/modules/global/dialog/integral-recharge-template.htm"],function(e){if($("#_integral-recharge").length<=0){var t=document.createElement("div");t.innerHTML=_["template"](e)({data:{enable:i}}),document.body.appendChild(t)}$(".dialog-close").unbind("click").bind("click",function(){$("#_integral-recharge").parent().remove()}),$("#reward-now").unbind("click").bind("click",n),$("#input-amount").unbind("change").bind("change",function(){var e=this;e.value<=0&&(e.value=1),$("#total_money").text(e.value)}),$("#setAmount").unbind("click").bind("click",function(){$("#getAmount").val(parseInt(50*Math.random()))}),$(".wx-pay").unbind("click").bind("click",function(){util.wxPay()}),$(".zfb-pay").unbind("click").bind("click",function(){var e=$("#input-amount").val();return 0>=e?void util.msg.warning("输入金额必须大于零"):($("#_integral-recharge").parent().remove(),void util.zfbPay({payAmount:e,purpose:2,payCallbackOk:function(){n&&n()}}))})})},IntegralExchangeDialog:function(e){var t=e||{},i=t.hasIntegral,n=t.rateOfExchange,o=t.callBackSure,a=t.type,r={type:a,hasIntegral:i,rateOfExchange:n};require(["text!/Public/Home/assets/js/modules/global/dialog/integral-exchange-template.htm"],function(e){if(sessionStorage.setItem("DialogTemplate",e.slice(e.lastIndexOf("</style>")+8)),$("#_dialog-exchange-integral").length<=0){var t=document.createElement("div");t.innerHTML=_["template"](e)({data:r}),document.body.appendChild(t)}var a=parseInt(n.slice(0,n.indexOf("=")));$("#exchange-val").val(parseInt(i/a)),$(".dialog-close,#exchange-no").unbind("click").bind("click",function(){$("#_dialog-exchange-integral").parent().remove()}),$("#exchange-val").unbind("change").bind("change",function(){var e=$("#exchange-val").val();0>=e&&$("#exchange-val").val(1)}),$("#exchange-ok").unbind("click").bind("click",function(){o&&o()})})},rewardDeveloperDetail:function(e){var t=e||{},i=t.totalPage,n=t.headImg,o=t.username,a=t.money,r=t.integral,l=1,c=t.callBackFun,s=t.list;require(["text!/Public/Home/assets/js/modules/global/dialog/reward-developer-detail-template.htm"],function(e){
if($("#_rewardDialogDetail").length<=0){var t=document.createElement("div");t.innerHTML=_["template"](e)({data:{headImg:n,username:o,money:a,integral:r,totalPage:i,currentPage:l,list:s}}),document.body.appendChild(t)}c&&c(),$(".dialog-close").unbind("click").bind("click",function(){$("#_rewardDialogDetail").parent().remove()})})},privateLetter:function(e,t){require(["text!/Public/Home/assets/js/modules/global/dialog/private-letter-template.htm"],function(i){if($("#_dialog-private-letter").length<=0){var n=document.createElement("div");n.innerHTML=i,document.body.appendChild(n)}$("#toName").val(e),$("#toContent").val(""),$(".dialog-close").unbind("click").bind("click",function(){$("#_dialog-private-letter").parent().remove()}),$(".private-send").unbind("click").bind("click",function(){return""==$("#toName").val()?void util.msg.warning("请输入发送人"):""==$("#toContent").val()?void util.msg.warning("请输入发送内容"):void C.ajax({url:"/Message/addMsg",type:"post",data:{uid:t,content:$("#toContent").val()},success:function(e){e.status&&(util.msg.success(e.info),setTimeout(function(){$("#_dialog-private-letter").parent().remove()},200))},error:function(){util.msg.error("网络异常，请稍后重试")}})})})},loadingDialog:function(e,t){C.ajax({url:"/Public/Home/assets/js/modules/Tools/view/custom-loading-template.htm",async:!1,type:"get",success:function(i){var n=$("#loading-dialog");if(n.length<=0){var o=document.createElement("div");o.innerHTML=i,document.body.appendChild(o)}else n.show();$("#loading-dialog").css({left:t,top:e})}})},userHeadDialog:function(e){e=e||{},require(["text!/Public/Home/assets/js/modules/Tools/view/head-hover-template.htm"],function(t){sessionStorage.setItem("DialogTemplate",t);var i=$("#user-head-dialog");if(i.length<=0){var n=document.createElement("div");n.innerHTML=_["template"](t)({data:e}),document.body.appendChild(n)}else{var o=sessionStorage.getItem("DialogTemplate");i[0].outerHTML=_["template"](o)({data:e}),i.show()}var a=$("#user-head-dialog").height();e.offsetTop-document.body.scrollTop>=a?($("#user-head-dialog .triangle_border_up").hide(),$("#user-head-dialog .triangle_border_down").show(),$("#user-head-dialog").css({left:e.offsetLeft,top:e.offsetTop-a-10}),$("#user-head-dialog .triangle_border_down").css({top:a-1})):($("#user-head-dialog .triangle_border_up").show(),$("#user-head-dialog .triangle_border_down").hide(),$("#user-head-dialog").css({left:e.offsetLeft,top:e.offsetTop+e.eHeight+10})),$("#private-letter").unbind("click").bind("click",function(){$("#user-head-dialog").hide(),util.privateLetter(e.username,e.uid)})})},picViewer:function(e,t){var i=e||[];require(["text!/Public/Home/assets/js/modules/Tools/view/picture-viewer-template.htm"],function(e){if($("#picViewer").length<=0){var n=document.createElement("div");n.innerHTML=_["template"](e)({data:i,index:t}),document.body.appendChild(n)}$(".pic-container ul li").css({"line-height":$(".pic-wrap").height()+"px"});var o=function(e){var t=$(".pic-container ul li").length-1,i=$(".pic-cur");if(i.length>0){var n=Number(i[0].className.replace("pic-num-","").replace(" pic-cur","")),o=$(".pic-num-"+n);o.removeClass("pic-cur"),o.hide(),"next"==e?n==t?n=0:n++:"pre"==e&&(0==n?n=t:n--),o=$(".pic-num-"+n),o.css({"line-height":$(".pic-wrap").height()+"px"}),o.show(),o.addClass("pic-cur")}};document.documentElement.style.overflow="hidden",$(document).unbind("keypress mousewheel").bind("keypress mousewheel",function(e,t){if("keypress"==e.type)32==e.keyCode&&o("next");else{var i=t>0?"Up":"Down";o("Up"==i?"pre":"next")}}),$(".pic-next").unbind("click").bind("click",function(){o("next")}),$(".pic-pre").unbind("click").bind("click",function(){o("pre")}),$(".close-pic").unbind("click").bind("click",function(){$("#picViewer").parent().remove(),document.documentElement.style.overflow="auto"})})},retrievePassword:function(e){var t=e||{},i=t.email,n=t.callBackOk;if($("#find-email-dialog").length<=0){var o=document.createElement("div");o.innerHTML='<div id="find-email-dialog"><div class="mask"></div><div class="dialog"><div class="dialog-head"><span class="dialog-title">找回密码</span><span class="dialog-close">X</span></div><div class="dialog-wrap"><p style="line-height: 18px">我们将向您的注册邮箱'+i+'发送一份密码找回邮件,请你注意查收</p><div class="dialog-btn1" id="send-ok">确认发送</div></div></div></div>',document.body.appendChild(o)}$(".dialog-close").unbind("click").bind("click",function(){$("#find-email-dialog").parent().remove()}),$("#send-ok").unbind("click").bind("click",function(){n&&n()})},msg:function(){for(var e={},t=["info","error","warning","success"],i=0;i<t.length;i++)e[t[i]]=function(){var e=t[i];return function(t,i){util.tip(t,i,e)}}();return e}(),tip:function(){var e={};return function(t,i,n){n=n||"info",i=i/1e3||2.5;var o=document.getElementById("_tips");if(!o){var a=document.createElement("div");a.innerHTML='<div id="_tips" class="_tips"><span id="tip_icon" class="tip_icon"></span><span id="tip_text" class="tip_text"></span></div>',document.body.appendChild(a)}text=document.getElementById("tip_text"),text.innerHTML=t,o=document.getElementById("_tips"),tip=document.getElementById("tip_icon"),tip.style.backgroundImage="url(/Public/Home/assets/images/tip-icon.png)","success"==n?(tip.style.backgroundPosition="0 0",o.style.backgroundColor="#0078d7"):"error"==n?(tip.style.backgroundPosition="-37px 0",o.style.backgroundColor="#E60707"):"warning"==n&&(tip.style.backgroundPosition="-78px 0",o.style.backgroundColor="#F5A700"),o.style.webkitAnimation="none",o.style.animation="none",e.timmer&&(clearTimeout(e.timmer),e.timmer=null),e.timmer=setTimeout(function(){o.style.webkitAnimation="tip "+i+"s",o.style.animation="tip "+i+"s"},120)}}(),tip2:function(){var e={};return function(t,i,n){n=n||"info",i=i||2e3;var o=document.getElementById("_tips");if(!o){var a=document.createElement("div");a.innerHTML='<div id="_tips" style="z-index:9999;font-size:12px;position: fixed;left: 50%;top: 0;border-radius: 3px;box-sizing: content-box;padding: 15px;background: #0078d7;color: #ffffff;box-shadow: 0 0 3px 1px rgba(0,0,0,0.2);-webkit-transition:all 0.3s;-webkit-transform: translate3d(0,-300%,0);"><span id="tip_icon" style="float: left;width: 27px;height: 27px"></span><span id="tip_text" style="float: left;line-height: 27px;padding-left: 10px"></span></div>',document.body.appendChild(a)}text=document.getElementById("tip_text"),text.innerHTML=t,document.getElementById("_tips").style.marginLeft=-(document.getElementById("_tips").offsetWidth/2)+"px",tip=document.getElementById("tip_icon"),tip.style.backgroundImage="url(/Public/Home/assets/images/tip-icon.png)","success"==n?tip.style.backgroundPosition="0 0":"error"==n?tip.style.backgroundPosition="-37px 0":"warning"==n&&(tip.style.backgroundPosition="-78px 0"),o=document.getElementById("_tips"),e.timmer&&(clearTimeout(e.timmer),e.timmer=null),o.style.webkitTransition="none",o.style.webkitTransform="translate3d(0px, -300%, 0px)",setTimeout(function(){o.style.webkitTransition="all 0.3s",o.style.webkitTransform="translate3d(0px, 100%, 0px)"},300),e.timmer=setTimeout(function(){o.style.webkitTransform="translate3d(0px, -300%, 0px)"},i)}}(),reportDialog:function(e){var t=e||{},i=t.arrList,n=t.callBackSuc;require(["text!/Public/Home/assets/js/modules/global/dialog/report-template.htm"],function(e){if($("#report-dialog").length<=0){var t=document.createElement("div");t.innerHTML=_["template"](e)({data:{orderAmount:i}}),document.body.appendChild(t)}$(".dialog-close,#dialog-cancel").unbind("click").bind("click",function(){$("#report-dialog").parent().remove()});var o,a=0;$(".report-style").unbind("click").bind("click",function(e){$(e.currentTarget).closest("li").siblings("li").find("span").removeClass("report-cur"),$(e.currentTarget).toggleClass("report-cur"),a=-1!=e.currentTarget.className.indexOf("report-cur")?1:0,o=this.id}),$("#report_content").val(""),$("#dialog-sure").unbind("click").bind("click",function(){return 0==a?void util.msg.warning("请选择举报类型"):""==$(".report_content").val()?void util.msg.warning("请选择举报内容"):void(n&&n($("#report_content").val(),o))})})},uploadPic:function(e){var t=e||{},i=t.type,n=t.file,o=t.submitCallBack,a=function(e,t,n){util.ajaxUpload({type:i,width:e,height:t,base64:n},function(e){o&&o(e)})},r=new Image;if(window.FileReader)oFReader=new FileReader,oFReader.readAsDataURL(n.files[0]),oFReader.onload=function(e){r.src=e.target.result,a(r.width,r.height,r.src)};else if(document.all){n.select(),n.blur(),document.getElementById("v5c").focus();var l=document.selection.createRange().text;window.ie6?r.src=l:(r.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod='image',src=\""+l+'")',r.src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="),a(r.width,r.height,r.src)}else n.files&&n.files.item(0)&&(url=n.files.item(0).getAsDataURL(),r.src=url,a(r.width,r.height,r.src))},uploadPicDialog:function(e){var t=e||{},i=t.type,n=t.showAreaSelect,o=t.title,a=t.file,r=t.closeCallBack,l=t.submitCallBack,c=function(e,t){if(!e.files[0])return void $("#upload-pic-dialog").parent().remove();var i=new Image;if(window.FileReader)oFReader=new FileReader,oFReader.readAsDataURL(e.files[0]),oFReader.onload=function(e){i.src=e.target.result,t&&t(i)};else if(document.all){e.select();var n=document.selection.createRange().text;window.ie6?i.src=n:(i.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod='image',src=\""+n+'")',i.src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="),t&&t(i)}else e.files&&e.files.item(0)&&(url=e.files.item(0).getAsDataURL(),i.src=url,t&&t(i))},s=function(e,t){var i=e.width,n=e.height;i>=n&&i>600?(n/=i/600,i=600):n>i&&n>300&&(i/=n/300,n=300),e.width=i,e.height=n,$(".upload-tool-img").empty().append(e),$("#upload-pic-dialog").show(),t&&t(e,i,n)},d=function(e,t,i,n){var o=0,a=0,r=150,l=150,c=e.src,s=1;t>=i&&t>600&&(s=t/600),i>t&&i>300&&(s=i/300),r>t&&i>t&&(r=t,l=r),l>i&&t>i&&(l=i,r=l),r>t&&l>i&&t==i&&(r=t,l=i),require(["jquery.imgareaselect.min"],function(){$(e).imgAreaSelect({x1:o,y1:a,x2:r,y2:l,aspectRatio:"1:1",minWidth:60,minHeight:60,parent:".dialog",onInit:function(){n&&n({x1:o,y1:a,scaling:s,width:r-o,height:l-a,base64:c})},onSelectEnd:function(e,t){o=t.x1,a=t.y1,r=t.x2,l=t.y2,n&&n({x1:o,y1:a,scaling:s,width:r-o,height:l-a,base64:c})}})})};require(["text!/Public/Home/assets/js/modules/global/dialog/upload-pic-template.htm"],function(e){function t(){n&&$(".upload-tool-img img").imgAreaSelect({remove:!0}),$("#upload-pic-dialog").parent().remove(),r&&r()}if($("#upload-pic-dialog").length<=0){var u=document.createElement("div");u.innerHTML=_["template"](e)({title:o}),document.body.appendChild(u)}$(".dialog-close").unbind("click").bind("click",$.proxy(t,this)),c(a,function(e){s(e,function(e,t,o){if(n)d(e,t,o,function(e){var t=$.extend(e,{type:i});$(".upload-dialog-btn").unbind("click").bind("click",$.proxy(function(){util.ajaxUpload(t,function(e){$(".upload-tool-img img").imgAreaSelect({remove:!0}),$("#upload-pic-dialog").parent().remove(),l&&l(e)})},this))});else{var a={type:i,base64:e.src};$(".upload-dialog-btn").unbind("click").bind("click",function(){util.ajaxUpload(a,function(e){$("#upload-pic-dialog").parent().remove(),l&&l(e)})})}})})})},ajaxUpload:function(e,t){C.ajax({url:"/Upload/uploadIcon",dataType:"json",type:"post",data:e,showDefaultLoading:!0,success:function(e){if(e.status){var i=e.info;t&&t(i)}else util.msg.warning(e.info)},error:function(){util.msg.warning("上传失败")}})},initCarouseImg:function(){var e=$("#index-pic ul").children().length,t=0,n=function(){var n=$("#index-pic ul li"),o=$("#carousel-num span");for(o.removeClass("carousel-cur"),t==e-1?t=0:t+=1,i=0;i<e;i++)n.eq(i).css("display","none");n.eq(t).fadeIn(400),o.eq(t).addClass("carousel-cur")};$("#index-pic ul li,#carousel-num span").mouseenter(function(){window.clearInterval(o)}),$("#carousel-num span").mouseenter(function(){$(this).index()!=t&&(t=$(this).index()-1,n())});var o=setInterval(n,5e3);$("#index-pic ul li,#carousel-num span").mouseleave(function(){o=setInterval(n,5e3)})},initCarousePic:function(e){var t=e.wrap,i=e.pre,n=e.next,o=e.delay,a=e.speed,r=e.autoRoll||!1,l=e.dots,c=t.find(".carousel-num span"),s=t.find(".carousel-pic-zone"),d=s.find("ul li"),u=d.length,p=d.width();s[0].style.width=p*u+"px",l?$(".carousel-num").show():$(".carousel-num").hide();var m,g=1,f=function(){n.trigger("click"),m=setTimeout(f,o)},h=function(e){e.hover(function(){$(".carousel-arrow").css("opacity",.6),clearTimeout(m)},function(){$(".carousel-arrow").css("opacity",.1),f()})};r&&f(),i.off("click").on("click",function(){s.is(":animated")||(1==g?(s.animate({left:"-="+p*(u-1)},a),g=u):(s.animate({left:"+="+p},a),g--),c.eq(g-1).addClass("carousel-cur").siblings().removeClass("carousel-cur"))}),n.off("click").on("click",function(){s.is(":animated")||(g==u?(s.animate({left:0},a),g=1):(s.animate({left:"-="+p},a),g++),c.eq(g-1).addClass("carousel-cur").siblings().removeClass("carousel-cur"))}),c.off("click").on("click",function(){if(!s.is(":animated")){var e=c.index(this);s.animate({left:"-"+p*e},a),g=e+1,$(this).addClass("carousel-cur").siblings().removeClass("carousel-cur")}}),h(s),h(i),h(n),h(c)},initCarouseAd:function(e){var t=e||{},i=t.id,n=t.w||1500,o=t.fq||10,a=t.h,r=-1==t.n?-1:1,l=!0,c=document.getElementById(i),s=document.getElementById("notice-next"),d=document.getElementById("notice-pre");c.innerHTML+=c.innerHTML,c.onmouseover=function(){l=!1},c.onmouseout=function(){l=!0},s.onmouseleave=function(){clearTimeout(u),clearTimeout(p),clearTimeout(m),r=1,p=setTimeout(function(){!new function(){var e=c.scrollTop%a==0&&!l;if(!e){var t=r>0?[g,0]:[0,g];c.scrollTop==t[0]?c.scrollTop=t[1]:c.scrollTop+=r}u=setTimeout(arguments.callee,c.scrollTop%a?o:n)}},1200)},d.onmouseleave=function(){clearTimeout(u),clearTimeout(p),clearTimeout(m),r=1,p=setTimeout(function(){!new function(){var e=c.scrollTop%a==0&&!l;if(!e){var t=r>0?[g,0]:[0,g];c.scrollTop==t[0]?c.scrollTop=t[1]:c.scrollTop+=r}u=setTimeout(arguments.callee,c.scrollTop%a?o:n)}},1200)},s.onclick=function(){clearTimeout(u),clearTimeout(p),clearTimeout(m),r=1,new function(){var e=r>0?[g,0]:[0,g];c.scrollTop==e[0]?c.scrollTop=e[1]:c.scrollTop+=r,c.scrollTop%a!=0&&(m=setTimeout(arguments.callee,c.scrollTop%a?o:n))}},d.onclick=function(){clearTimeout(u),clearTimeout(p),clearTimeout(m),r=-1,new function(){var e=r>0?[g,0]:[0,g];c.scrollTop==e[0]?c.scrollTop=e[1]:c.scrollTop+=r,c.scrollTop%a!=0&&(m=setTimeout(arguments.callee,c.scrollTop%a?o:n))}};var u,p,m,g=parseInt(c.scrollHeight/2);!new function(){var e=c.scrollTop%a==0&&!l;if(!e){var t=r>0?[g,0]:[0,g];c.scrollTop==t[0]?c.scrollTop=t[1]:c.scrollTop+=r}u=setTimeout(arguments.callee,c.scrollTop%a?o:n)}},initCarouseAd2:function(e){var t=e.wrap,i=e.pre,n=e.next,o=e.delay,a=e.autoRoll||!1,r=e.speed,l=t.find(".carousel-ad-zone"),c=l.find("ul li"),s=c.length,d=c.height();l[0].style.height=d*s+"px";var u,p=1,m=function(){n.trigger("click"),u=setTimeout(m,o)},g=function(e){e.hover(function(){clearTimeout(u)},function(){m()})};a&&m(),i.off("click").on("click",function(){l.is(":animated")||(1==p?(l.animate({top:"-="+d*(s-1)},r),p=s):(l.animate({top:"+="+d},r),p--))}),n.off("click").on("click",function(){l.is(":animated")||(p==s?(l.animate({top:0},r),p=1):(l.animate({top:"-="+d},r),p++))}),g(l),g(i),g(n)}};return util});